<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <th:block th:replace="brand-owner/common/head"></th:block>
    <body id="page-top">

        <!-- Page Wrapper -->
        <div id="wrapper">

            <!-- Sidebar -->
            <th:block th:replace="brand-owner/common/sidebar"></th:block>
            <!-- End of Sidebar -->

            <!-- Content Wrapper -->
            <div id="content-wrapper" class="d-flex flex-column">

                <!-- Main Content -->
                <div id="content">

                    <!-- Topbar -->
                    <th:block th:replace="brand-owner/common/navbar"></th:block>
                    <!-- End of Topbar -->

                    <!-- Begin Page Content -->
                    <div class="container-fluid">

                        <!-- DataTales Example -->
                        <div class="card shadow mb-4">
                            <div class="card-header py-3">
                                <h2 class="m-0 font-weight-bold text-primary">Thêm chủ cơ sở mới</h2>
                            </div>
                            <div class="card-body">
                                <div class="card-box">
                                    <h2 class="fs-title text-center">Thông tin cơ bản</h2>
                                    <form id="formSubmit" action="/brand-owner/gym-owner/add" method="post" th:object="${gymOwner}">
                                        <div class="row">
                                            <div class="col-md-2 mb-4">
                                                <label for="department-img" class="form-label fw-bold w-100">Ảnh
                                                    :</label>
                                                <img class="show-department-img" src="img/undraw_profile_2.svg">
                                                <input type="file" class="form-control mt-2" id="department-img"
                                                       name="department-img" accept="image/*"
                                                       onchange="uploadImage(this);">
                                                <input th:field="*{imageUrl}" type="hidden" id="avatarImg" name="imageUrl">
                                                <span th:if="${#fields.hasErrors('imageUrl')}" th:errors="*{imageUrl}">photoUrl Error</span>
                                            </div>
                                            <div class="col-md-5 mb-4">
                                                <div class="mb-4">
                                                    <label for="first-name" class="form-label fw-bold">Họ :</label>
                                                    <input th:field="*{firstName}" type="text" class="form-control" id="first-name"
                                                           name="firstName" placeholder="Nhập họ">
                                                    <span th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}">photoUrl Error</span>
                                                </div>
                                                <div class="mb-4">
                                                    <label for="email" class="form-label fw-bold">Email :</label>
                                                    <input th:field="*{email}" type="text" class="form-control" id="email" name="email"
                                                           placeholder="Nhập gmail">
                                                    <span th:if="${#fields.hasErrors('email')}" th:errors="*{email}">photoUrl Error</span>
                                                </div>
                                                <div class="mb-4">
                                                    <label for="address" class="form-label fw-bold">Địa chỉ :</label>
                                                    <input th:field="*{address}" type="text" class="form-control" id="address" name="address"
                                                           placeholder="Nhập địa chỉ">
                                                    <span th:if="${#fields.hasErrors('address')}" th:errors="*{address}">photoUrl Error</span>
                                                </div>
                                                <div class="mb-4">
                                                    <label for="date-of-birth" class="form-label fw-bold">Ngày Sinh
                                                        :</label>
                                                    <input th:field="*{dateOfBirth}" type="date" class="form-control" id="date-of-birth"
                                                           name="dateOfBirth">
                                                    <span th:if="${#fields.hasErrors('dateOfBirth')}" th:errors="*{dateOfBirth}">photoUrl Error</span>
                                                </div>
                                                <div class="mb-4">
                                                    <label for="gender" class="form-label fw-bold">Giới Tính :</label>
                                                    <select th:field="*{gender}" class="form-select" id="gender" name="gender">
                                                        <option value="">Chọn giới tính</option>
                                                        <option value="Male">Nam</option>
                                                        <option value="Female">Nữ</option>
                                                        <option value="Khác">Khác</option>
                                                    </select>
                                                    <span th:if="${#fields.hasErrors('gender')}" th:errors="*{gender}">photoUrl Error</span>
                                                </div>
                                            </div>
                                            <div class="col-md-5 mb-4">
                                                <div class="mb-4">
                                                    <label for="last-name" class="form-label fw-bold">Tên :</label>
                                                    <input th:field="*{lastName}" type="text" class="form-control" id="last-name"
                                                           name="lastName" placeholder="Nhập tên">
                                                    <span th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}">photoUrl Error</span>
                                                </div>
                                                <div class="mb-4">
                                                    <label for="username" class="form-label fw-bold">Tên đăng nhập
                                                        :</label>
                                                    <input th:field="*{username}" type="text" class="form-control" id="username" name="username"
                                                           placeholder="Nhập tên người dùng">
                                                    <span th:if="${#fields.hasErrors('username')}" th:errors="*{username}">photoUrl Error</span>
                                                </div>
                                                <div class="mb-4">
                                                    <label for="phone" class="form-label fw-bold">Số Điện Thoại
                                                        :</label>
                                                    <input th:field="*{phone}" type="number" class="form-control" id="phone" name="phone"
                                                           placeholder="Nhập số điện thoại">
                                                    <span th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}">photoUrl Error</span>
                                                </div>
                                                <div class="mb-4">
                                                    <label  for="id-card" class="form-label fw-bold">Số Căn Cước
                                                        :</label>
                                                    <input th:field="*{idCard}" type="text" class="form-control" id="id-card" name="idCard"
                                                           placeholder="Nhập số căn cước">
                                                    <span th:if="${#fields.hasErrors('idCard')}" th:errors="*{idCard}">photoUrl Error</span>
                                                </div>
                                            </div>
                                            <div class="col-md-12 text-center">
                                                <input id="addGymownerBtn" class="btn btn-submit" type="submit" value="Thêm chủ cơ sở">
                                            </div>
                                        </div>

                                    </form>
                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- /.container-fluid -->
                </div>
                <!-- End of Main Content -->

                <!-- Footer -->
                <th:block th:replace="brand-owner/common/footer"></th:block>
                <!-- End of Footer -->
            </div>
            <!-- End of Content Wrapper -->
        </div>
        <!-- End of Page Wrapper -->

        <!-- Scroll to Top Button-->
        <a class="scroll-to-top rounded" href="#page-top">
            <i class="fas fa-angle-up"></i>
        </a>


        <th:block th:replace="brand-owner/common/script"></th:block>
        <script>
            function uploadImage(input) {
                if (input.files && input.files[0]) {
                    const file = input.files[0];

                    var formData = new FormData();
                    formData.append("file", file);
                    $.ajax({
                        type: "POST",
                        url: `/upload/uploadAvatar`,
                        data: formData,
                        processData: false,
                        contentType: false,
                        success: function (response) {
                            console.log(response)
                            $("#avatarImg").val(response);
                        },
                        error: function () {
                            console.log("Failed to upload file");
                        }
                    });

                    var reader = new FileReader();

                    reader.onload = function (e) {
                        var img = document.querySelector('.show-department-img');
                        img.src = e.target.result;
                    };

                    reader.readAsDataURL(input.files[0]);
                }
            }

            $("#addGymownerBtn").click(function (event) {
                event.preventDefault()
                Swal.fire({
                    title: 'Bạn có muốn thêm chủ deparment mới không?',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'Có',
                    cancelButtonText: 'Không'
                }).then((result) => {
                    if (result.isConfirmed) {
                        $("#formSubmit").submit();
                    } else {

                    }
                });
            })
        </script>

    </body>

</html>

